<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Zhili">
<meta name="description" content="Sed magna purus, fermentum eu, tincidunt eu, varius ut, felis. Morbi mollis tellus ac sapien. Vestibulum ullamcorper mauris at ligula. In hac habitasse platea dictumst. Vivamus in erat ut urna cursus vestibulum.
    ">
<meta name="keywords" content="博客, 技术, 生物信息，精准医疗, 遗传咨询, 高通量技术, 算法, 学习, 作品, 写作, C&#43;&#43;, Perl">
<meta name="referrer" content="always">
<title>Binary search review - sy123.ml</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="/logo/favicon.ico" type="image/x-icon">
</head>
<body>
<header>
  <div>
    <h1><a href="https://sy123.ml/">sy123.ml</a></h1><h2><a href="https://sy123.ml/">winter is coming.</a></h2>
  </div>
  <nav><a href="/tags/">Tags</a><a href="/about/">About</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>Binary search review</h1>
  </div>
<div class="meta">
  <div>2016-12-29 00:00</div>
  <div>
    <span><a href="https://sy123.ml/tags/algorithm/">#algorithm</a></span>
      </div>
  </div>
<div class="content">
  <p>Detailed review on binary search.</p>
<!-- toc -->
<p>This post is based on an article on binary search from <a href="http://www.topcoder.com/community/data-science/data-science-tutorials/binary-search/">Topcoder</a>.</p>
<h1 id="classic-finding-a-value-in-a-sorted-sequence">Classic: Finding a value in a sorted sequence</h1>
<p>Consider the following sequence of integers sorted in ascending order and say we are looking for the number 55:</p>
<p>| 0 | 5 | 13 | 19 | 22 | 41 | 55 | 68 | 72 | 81 | 98 |</p>
<p>&ndash;&gt;</p>
<p>| 55 | 68 | 72 | 81 | 98 |</p>
<p>&ndash;&gt;</p>
<p>| 55 | 68 |</p>
<p>Depending on how we choose the median of an even number of elements we will either find 55 in the next step or chop off 68 to get a search space of only one element. Either way, we conclude that the index where the target value is located is 7.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">binary_search</span><span style="color:#111">(</span><span style="color:#111">A</span><span style="color:#111">,</span> <span style="color:#111">target</span><span style="color:#111">)</span><span style="color:#111">:</span>
   <span style="color:#111">lo</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#111">hi</span> <span style="color:#f92672">=</span> <span style="color:#111">size</span><span style="color:#111">(</span><span style="color:#111">A</span><span style="color:#111">)</span>
   <span style="color:#00a8c8">while</span> <span style="color:#111">lo</span> <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> <span style="color:#111">hi</span><span style="color:#111">:</span>
      <span style="color:#111">mid</span> <span style="color:#f92672">=</span> <span style="color:#111">lo</span> <span style="color:#f92672">+</span> <span style="color:#111">(</span><span style="color:#111">hi</span><span style="color:#f92672">-</span><span style="color:#111">lo</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>
      <span style="color:#00a8c8">if</span> <span style="color:#111">A</span><span style="color:#111">[</span><span style="color:#111">mid</span><span style="color:#111">]</span> <span style="color:#f92672">==</span> <span style="color:#111">target</span><span style="color:#111">:</span>
         <span style="color:#00a8c8">return</span> <span style="color:#111">mid</span>            
      <span style="color:#00a8c8">else</span> <span style="color:#00a8c8">if</span> <span style="color:#111">A</span><span style="color:#111">[</span><span style="color:#111">mid</span><span style="color:#111">]</span> <span style="color:#f92672">&lt;</span> <span style="color:#111">target</span><span style="color:#111">:</span> 
         <span style="color:#111">lo</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
      <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
         <span style="color:#111">hi</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
            
   <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#111">target</span> <span style="color:#111">was</span> <span style="color:#f92672">not</span> <span style="color:#111">found</span>

</code></pre></td></tr></table>
</div>
</div><h1 id="taking-it-further-the-main-theorem">Taking it further: the main theorem</h1>
<p>Consider a predicate p defined over some ordered set S (the search space). The search space consists of candidate solutions to the problem. We use the predicate to verify if a candidate solution is legal (does not violate some constraint) according to the definition of the problem.</p>
<blockquote>
<p>&ldquo;Main theorem&rdquo;: <strong>binary search can be used if and only if for all x in S, p(x) implies p(y) for all y &gt; x</strong></p>
</blockquote>
<p>We can use binary search to find the smallest legal solution (i.e. the smallest x for which p(x) is true) by following two steps:</p>
<ol>
<li>Designing a predicate. Note that we need to choose what the algorithm should find - either the first x for which p(x) is true or the last x for which p(x) is false.</li>
<li>Proving that binary search can be applied to the predicate. This is where we use the main theorem, verifying that the conditions laid out in the theorem are satisfied.</li>
</ol>
<p>These two parts are most often interleaved: when we think a problem can be solved by binary search, we aim to design the predicate so that it satisfies the condition in the main theorem.</p>
<h1 id="implementation">Implementation</h1>
<p>Given an array A (following array) and a target value (say 55), return the index of the first element in A equal to or greater than the target value.</p>
<p>Sample sequence:</p>
<p>| 0 | 5 | 13 | 19 | 22 | 41 | 55 | 68 | 72 | 81 | 98 |</p>
<p>Solution:</p>
<p>Predicate p(A[x]): &ldquo;Is A[x] greater than or equal to the target value?&quot;.</p>
<p>Search space <strong>S</strong> (indices):</p>
<p>| 1 | 2 | 3  | 4  | 5  | 6  | 7  | 8  | 9  | 10 | 11 |</p>
<p>Apply the predicate (with a target value of 55) to array A:</p>
<p>| no | no | no | no | no | no | yes | yes | yes | yes | yes |</p>
<p>Implementing the discrete algorithm:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">binary_search</span><span style="color:#111">(</span><span style="color:#111">lo</span><span style="color:#111">,</span> <span style="color:#111">hi</span><span style="color:#111">,</span> <span style="color:#111">p</span><span style="color:#111">)</span><span style="color:#111">:</span>
   <span style="color:#00a8c8">while</span> <span style="color:#111">lo</span> <span style="color:#f92672">&lt;</span> <span style="color:#111">hi</span><span style="color:#111">:</span>
      <span style="color:#111">mid</span> <span style="color:#f92672">=</span> <span style="color:#111">lo</span> <span style="color:#f92672">+</span> <span style="color:#111">(</span><span style="color:#111">hi</span><span style="color:#f92672">-</span><span style="color:#111">lo</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>
      <span style="color:#00a8c8">if</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">mid</span><span style="color:#111">)</span> <span style="color:#f92672">==</span> <span style="color:#111">true</span><span style="color:#111">:</span>
         <span style="color:#111">hi</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span>
      <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
         <span style="color:#111">lo</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
          
   <span style="color:#00a8c8">if</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">lo</span><span style="color:#111">)</span> <span style="color:#f92672">==</span> <span style="color:#111">false</span><span style="color:#111">:</span>
      <span style="color:#111">complain</span>                <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#111">)</span> <span style="color:#f92672">is</span> <span style="color:#111">false</span> <span style="color:#00a8c8">for</span> <span style="color:#111">all</span> <span style="color:#111">x</span> <span style="color:#f92672">in</span> <span style="color:#111">S</span><span style="color:#960050;background-color:#1e0010">!</span>
      
   <span style="color:#00a8c8">return</span> <span style="color:#111">lo</span>         <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#111">lo</span> <span style="color:#f92672">is</span> <span style="color:#111">the</span> <span style="color:#111">least</span> <span style="color:#111">x</span> <span style="color:#00a8c8">for</span> <span style="color:#111">which</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#111">)</span> <span style="color:#f92672">is</span> <span style="color:#111">true</span>

</code></pre></td></tr></table>
</div>
</div><p>Two crucial lines:</p>
<ol>
<li>hi = mid :
When p(mid) is true, we can discard the second half of the search space, since the predicate is true for all elements in it (by the main theorem). However, we can not discard mid itself, since it may well be the first element for which p is true. This is why moving the upper bound to mid is as aggressive as we can do without introducing bugs.</li>
<li>lo = mid+1
If p(mid) is false, we can discard the first half of the search space, but this time including mid. p(mid) is false so we don’t need it in our search space. This effectively means we can move the lower bound to mid+1.</li>
</ol>
<p>If we wanted to find the last x for which p(x) is false:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">binary_search</span><span style="color:#111">(</span><span style="color:#111">lo</span><span style="color:#111">,</span> <span style="color:#111">hi</span><span style="color:#111">,</span> <span style="color:#111">p</span><span style="color:#111">)</span><span style="color:#111">:</span>
   <span style="color:#00a8c8">while</span> <span style="color:#111">lo</span> <span style="color:#f92672">&lt;</span> <span style="color:#111">hi</span><span style="color:#111">:</span>
      <span style="color:#111">mid</span> <span style="color:#f92672">=</span> <span style="color:#111">lo</span> <span style="color:#f92672">+</span> <span style="color:#111">(</span><span style="color:#111">hi</span><span style="color:#f92672">-</span><span style="color:#111">lo</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>    <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#111">note</span><span style="color:#111">:</span> <span style="color:#111">rounds</span> <span style="color:#111">up</span> <span style="color:#111">instead</span> <span style="color:#111">of</span> <span style="color:#111">down</span>
      <span style="color:#00a8c8">if</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">mid</span><span style="color:#111">)</span> <span style="color:#f92672">==</span> <span style="color:#111">true</span><span style="color:#111">:</span>
         <span style="color:#111">hi</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
      <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
         <span style="color:#111">lo</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span>
          
   <span style="color:#00a8c8">if</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">lo</span><span style="color:#111">)</span> <span style="color:#f92672">==</span> <span style="color:#111">true</span><span style="color:#111">:</span>
      <span style="color:#111">complain</span>                <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#111">)</span> <span style="color:#f92672">is</span> <span style="color:#111">true</span> <span style="color:#00a8c8">for</span> <span style="color:#111">all</span> <span style="color:#111">x</span> <span style="color:#f92672">in</span> <span style="color:#111">S</span><span style="color:#960050;background-color:#1e0010">!</span>
      
   <span style="color:#00a8c8">return</span> <span style="color:#111">lo</span>         <span style="color:#f92672">/</span><span style="color:#f92672">/</span> <span style="color:#111">lo</span> <span style="color:#f92672">is</span> <span style="color:#111">the</span> <span style="color:#111">greatest</span> <span style="color:#111">x</span> <span style="color:#00a8c8">for</span> <span style="color:#111">which</span> <span style="color:#111">p</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#111">)</span> <span style="color:#f92672">is</span> <span style="color:#111">false</span>
</code></pre></td></tr></table>
</div>
</div><p>Explanation:
If we use <code>mid = lo + (hi-lo)/2</code>, which rounds down, consider what happens when running this code on some search space for which the predicate gives:</p>
<p>| no | yes |</p>
<p>The code will get stuck in a loop. It will always select the first element as mid, but then will not move the lower bound because it wants to keep the no in its search space. So <code>mid</code> needs to round up instead of down.</p>
<p>Note:</p>
<ul>
<li>
<p>Why using mid = lo + (hi-lo)/2 instead of the usual mid = (lo+hi)/2?</p>
<ol>
<li>To avoid another potential rounding bug: in the first case, we want the division to always round down, towards the lower bound. But division truncates, so when lo+hi would be negative, it would start rounding towards the higher bound. Coding the calculation this way ensures that the number divided is always positive and hence always rounds as we want it to.</li>
<li>To avoid integer overflow.</li>
</ol>
</li>
<li>
<p>Just remember to always test the code on a two-element set where the predicate is false for the first element and true for the second.</p>
</li>
</ul>
<h1 id="example--fairworkload-httpcommunitytopcodercomstatcproblem-statementpm1901rd4650">Example: <a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=1901&amp;rd=4650"><em>FairWorkload</em></a></h1>
<p>In the problem, a number of workers need to examine a number of filing cabinets. The cabinets are not all of the same size and we are told for each cabinet how many folders it contains. We are asked to find an assignment such that each worker gets a sequential series of cabinets to go through and that it minimizes the maximum amount of folders that a worker would have to look through.</p>
<p>Solution:</p>
<ol>
<li>
<p>Imagine that we have an unlimited number of workers. For some number <em>MAX</em>, we can calculate the minimum number of workers needed so that each worker has to examine no more than <em>MAX</em> folders (if this is possible) by greedy algorithm:
We assign first worker to the cabinet 1. Since the cabinets must be assigned in sequential order (a worker cannot examine cabinets 1 and 3 without examining 2 as well), it’s always optimal to assign him to the second cabinet as well, if this does not take him over the limit we introduced (<em>MAX</em>). If it would take him over the limit, we conclude that his work is done and assign a new worker to the second cabinet. We proceed in a similar manner until all the cabinets have been assigned and assert that we’ve used the minimum number of workers possible, with the artificial limit (<em>MAX</em>) we introduced. Note here that the number of workers is inversely proportional to MAX: the higher we set our limit, the fewer workers we will need.</p>
</li>
<li>
<p>What we want is the smallest <em>MAX</em> such that the number of workers required is less than or equal to the number of workers available. So the predicate is:</p>
<p><strong>Can the workload be spread so that each worker has to examine no more than x folders, with the limited number of workers available?</strong></p>
</li>
<li>
<p>The code:</p>
</li>
</ol>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">int</span> <span style="color:#75af00">getMostWork</span><span style="color:#111">(</span> <span style="color:#111">vector</span>  <span style="color:#111">folders</span><span style="color:#111">,</span> <span style="color:#00a8c8">int</span> <span style="color:#111">workers</span> <span style="color:#111">)</span> <span style="color:#111">{</span>
   <span style="color:#00a8c8">int</span> <span style="color:#111">n</span> <span style="color:#f92672">=</span> <span style="color:#111">folders</span><span style="color:#111">.</span><span style="color:#111">size</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">;</span>
   <span style="color:#00a8c8">int</span> <span style="color:#111">lo</span> <span style="color:#f92672">=</span> <span style="color:#f92672">*</span><span style="color:#111">max_element</span><span style="color:#111">(</span> <span style="color:#111">folders</span><span style="color:#111">.</span><span style="color:#111">begin</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">,</span> <span style="color:#111">folders</span><span style="color:#111">.</span><span style="color:#111">end</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#111">)</span><span style="color:#111">;</span>
   <span style="color:#00a8c8">int</span> <span style="color:#111">hi</span> <span style="color:#f92672">=</span> <span style="color:#111">accumulate</span><span style="color:#111">(</span> <span style="color:#111">folders</span><span style="color:#111">.</span><span style="color:#111">begin</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">,</span> <span style="color:#111">folders</span><span style="color:#111">.</span><span style="color:#111">end</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span> <span style="color:#111">)</span><span style="color:#111">;</span>

   <span style="color:#00a8c8">while</span> <span style="color:#111">(</span> <span style="color:#111">lo</span> <span style="color:#f92672">&lt;</span> <span style="color:#111">hi</span> <span style="color:#111">)</span> <span style="color:#111">{</span>
      <span style="color:#00a8c8">int</span> <span style="color:#111">x</span> <span style="color:#f92672">=</span> <span style="color:#111">lo</span> <span style="color:#f92672">+</span> <span style="color:#111">(</span><span style="color:#111">hi</span><span style="color:#f92672">-</span><span style="color:#111">lo</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#111">;</span>

      <span style="color:#00a8c8">int</span> <span style="color:#111">required</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#111">current_load</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#111">;</span>
      <span style="color:#00a8c8">for</span> <span style="color:#111">(</span> <span style="color:#00a8c8">int</span> <span style="color:#111">i</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#111">;</span> <span style="color:#111">i</span><span style="color:#f92672">&lt;</span><span style="color:#111">n</span><span style="color:#111">;</span> <span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#111">i</span> <span style="color:#111">)</span> <span style="color:#111">{</span>
         <span style="color:#00a8c8">if</span> <span style="color:#111">(</span> <span style="color:#111">current_load</span> <span style="color:#f92672">+</span> <span style="color:#111">folders</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> <span style="color:#111">x</span> <span style="color:#111">)</span> <span style="color:#111">{</span>
            <span style="color:#75715e">// the current worker can handle it
</span><span style="color:#75715e"></span>            <span style="color:#111">current_load</span> <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#111">folders</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">;</span>
         <span style="color:#111">}</span>
         <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
            <span style="color:#75715e">// assign next worker
</span><span style="color:#75715e"></span>            <span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#111">required</span><span style="color:#111">;</span>
            <span style="color:#111">current_load</span> <span style="color:#f92672">=</span> <span style="color:#111">folders</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">;</span>               
         <span style="color:#111">}</span>
      <span style="color:#111">}</span>

      <span style="color:#00a8c8">if</span> <span style="color:#111">(</span> <span style="color:#111">required</span> <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> <span style="color:#111">workers</span> <span style="color:#111">)</span>
         <span style="color:#111">hi</span> <span style="color:#f92672">=</span> <span style="color:#111">x</span><span style="color:#111">;</span>
      <span style="color:#00a8c8">else</span>
         <span style="color:#111">lo</span> <span style="color:#f92672">=</span> <span style="color:#111">x</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#111">;</span>
   <span style="color:#111">}</span>

   <span style="color:#00a8c8">return</span> <span style="color:#111">lo</span><span style="color:#111">;</span>
<span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><p>To verify that the solution doesn’t lock up, we can use a small no/yes example with folders={1,1} and workers=1.</p>
<p>The overall complexity of the solution is O(n log SIZE), where SIZE is the size of the search space. This is very fast.</p>
<p>In this example, we used a greedy algorithm to evaluate the predicate. In other problems, evaluating the predicate can come down to anything from a simple math expression to finding a maximum cardinality matching in a bipartite graph.</p>
<h1 id="conclusion">Conclusion</h1>
<ul>
<li>Design a predicate which can be efficiently evaluated and so that binary search can be applied</li>
<li>Decide on what you’re looking for and code so that the search space always contains that (if it exists)</li>
<li>If the search space consists only of integers, test your algorithm on a two-element set to be sure it doesn’t lock up</li>
<li>Verify that the lower and upper bounds are not overly constrained: it’s usually better to relax them as long as it doesn’t break the predicate. An all-around template looks like this according to my previous <a href="https:nianze.tk/2016/08/binary-search">post</a> on binary search:</li>
</ul>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Solution</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * @return first occurrence position of the target
</span><span style="color:#75715e">     */</span>
    <span style="color:#00a8c8">int</span> <span style="color:#75af00">findPosition</span><span style="color:#f92672">(</span><span style="color:#00a8c8">int</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> <span style="color:#111">nums</span><span style="color:#f92672">,</span> <span style="color:#00a8c8">int</span> <span style="color:#111">target</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">nums</span> <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#00a8c8">null</span> <span style="color:#f92672">|</span><span style="color:#f92672">|</span> <span style="color:#111">nums</span><span style="color:#f92672">.</span><span style="color:#75af00">length</span> <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#111">0</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#00a8c8">return</span> <span style="color:#f92672">-</span><span style="color:#111">1</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>   
        <span style="color:#00a8c8">int</span> <span style="color:#111">start</span> <span style="color:#f92672">=</span> <span style="color:#111">0</span><span style="color:#f92672">,</span> <span style="color:#111">end</span> <span style="color:#f92672">=</span> <span style="color:#111">nums</span><span style="color:#f92672">.</span><span style="color:#75af00">length</span> <span style="color:#f92672">-</span> <span style="color:#111">1</span><span style="color:#f92672">;</span>
        <span style="color:#00a8c8">while</span> <span style="color:#f92672">(</span><span style="color:#111">start</span> <span style="color:#f92672">+</span> <span style="color:#111">1</span> <span style="color:#f92672">&lt;</span> <span style="color:#111">end</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#00a8c8">int</span> <span style="color:#111">mid</span> <span style="color:#f92672">=</span> <span style="color:#111">start</span> <span style="color:#f92672">+</span> <span style="color:#f92672">(</span><span style="color:#111">end</span> <span style="color:#f92672">-</span> <span style="color:#111">start</span><span style="color:#f92672">)</span> <span style="color:#f92672">/</span> <span style="color:#111">2</span><span style="color:#f92672">;</span>
            <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">nums</span><span style="color:#f92672">[</span><span style="color:#111">mid</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#111">target</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#111">end</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span><span style="color:#f92672">;</span> <span style="color:#75715e">// for case of &#34;return first position&#34;
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//start = mid; for case of &#34;return last position&#34;
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//return mid; for case of &#34;return any position&#34;
</span><span style="color:#75715e"></span>            <span style="color:#f92672">}</span> <span style="color:#00a8c8">else</span> <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">nums</span><span style="color:#f92672">[</span><span style="color:#111">mid</span><span style="color:#f92672">]</span> <span style="color:#f92672">&lt;</span> <span style="color:#111">target</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#111">start</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span> <span style="color:#00a8c8">else</span> <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">nums</span><span style="color:#f92672">[</span><span style="color:#111">mid</span><span style="color:#f92672">]</span> <span style="color:#f92672">&gt;</span> <span style="color:#111">target</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#111">end</span> <span style="color:#f92672">=</span> <span style="color:#111">mid</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>   
        <span style="color:#75715e">// exchange the position of two [if statement] if want to return last postion
</span><span style="color:#75715e"></span>        <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">nums</span><span style="color:#f92672">[</span><span style="color:#111">start</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#111">target</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#00a8c8">return</span> <span style="color:#111">start</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">nums</span><span style="color:#f92672">[</span><span style="color:#111">end</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#111">target</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#00a8c8">return</span> <span style="color:#111">end</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// target strictly between {A[start-1], A[start]}
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// or strictly between {A[start], A[end]}
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// or strictly between {A[end, A[end+1]}
</span><span style="color:#75715e"></span>        <span style="color:#00a8c8">return</span> <span style="color:#f92672">-</span><span style="color:#111">1</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></td></tr></table>
</div>
</div></div>

  </article>
</main>
<footer>
  <div>
    <div>
      2007-2020 Zhili.</div>
  </div>
</footer>
</body>
</html>
