<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="zhili">
<meta name="description" content="Sed magna purus, fermentum eu, tincidunt eu, varius ut, felis. Morbi mollis tellus ac sapien. Vestibulum ullamcorper mauris at ligula. In hac habitasse platea dictumst. Vivamus in erat ut urna cursus vestibulum.
    ">
<meta name="keywords" content="博客, 技术, 生物信息，精准医疗, 遗传咨询, 高通量技术, 算法, 学习, 作品, 写作, C&#43;&#43;, Perl">
<meta name="referrer" content="always">
<title>批处理关闭或开启NETBIOS - zhili</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="/logo/favicon.ico" type="image/x-icon">
</head>
<body>
<header>
  <div>
    <h1><a href="https://sy123.ml/">zhili</a></h1>
  </div>
  <nav><a href="/tags/">Tags</a><a href="/about/">About</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>批处理关闭或开启NETBIOS</h1>
  </div>
<div class="meta">
  <div>2020-01-17 19:23</div>
  <div>
    <span><a href="https://sy123.ml/tags/windows/">#windows</a></span>
      <span><a href="https://sy123.ml/tags/netbios/">#netbios</a></span>
      </div>
  </div>
<div class="content">
  <p>禁用NETBIOS后，局域网内计算机不可以在地址栏用主机名访问你的主机，更安全。</p>
<p>以下为批处理自动关闭netbios脚本:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bat" data-lang="bat"><span style="color:#111">@</span><span style="color:#00a8c8">echo</span> off 
<span style="color:#75715e">rem off_netbios_Self_Del</span>
<span style="color:#00a8c8">for</span> <span style="color:#00a8c8">/L</span> <span style="color:#8045ff">%%</span>a <span style="color:#00a8c8">in</span> <span style="color:#111">(</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">20</span><span style="color:#111">)</span> <span style="color:#00a8c8">do</span> <span style="color:#111">(</span>
   wmic nicconfig where index=&#39;<span style="color:#8045ff">%%</span>a&#39; call settcpipnetbios 2
<span style="color:#111">)</span>
<span style="color:#00a8c8">cd</span> /d <span style="color:#111">%~dp0</span>
  <span style="color:#00a8c8">if</span> <span style="color:#00a8c8">exist</span> one_time.cmd <span style="color:#111">(</span>
  <span style="color:#00a8c8">del</span> /f /q <span style="color:#111">%0</span>
  <span style="color:#00a8c8">exit</span>
<span style="color:#111">)</span>
<span style="color:#00a8c8">rename</span> <span style="color:#111">%0</span> one_time.cmd
<span style="color:#00a8c8">exit</span>
</code></pre></td></tr></table>
</div>
</div><p>功能:
一键关闭netbios，执行完第二次后自己删除自己。</p>
<p>适用性:，
在win7及win2008测试通过，其它系统没测。</p>
<p>说明:
用法：复制上述脚本随便起个名，扩展名改为bat或者cmd。最好把文件放到开机启动目录，开机就运行。windows下自启动目录如下：
<code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</code></p>
<p>如何开启NETBIOS?
把上述代码第四行最后数字改为1即为开启，改为0即为默认设置，为2时代表关闭（上述代码已默认设为关闭NETBIOS)。</p>
<p>为何要第二次才删除？
如果是新装或者复制了系统，第一次开机是检测并安装网卡设备。如果未安装完网卡就运行完脚本，那脚本就发挥不了作用。</p>
<p>运行流程：
在运行第一次的时候会自动把本脚本重命名为one_time.cmd
在第二次运行脚本监测到有one_time.cmd文件后会自我删除。
本脚本用for循环20次，每个网卡都尝试关闭NETBIOS,（一般系统有十多个网卡序号）如果不够（不放心）就就把第三行代码由数字20改为30或更多。如果想要查看自己的网卡序号可以在CMD里输入以下命令：<code>wmic nicconfig Get Caption,index</code></p>
<p><a href="http://www.bathome.net/thread-38925-1-1.html">参考文档:批处理如何恢复Netbios</a></p>
</div>
<div class="disqus">
  <div id="disqus_thread"></div>
<script>





(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://sy123-ml.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
</div>

  </article>
</main>
<footer>
  <div>
    <div>
      2007-2020 zhili.</div>
  </div>
</footer>
</body>
</html>
