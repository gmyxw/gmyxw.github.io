<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Zhili">
<meta name="description" content="Sed magna purus, fermentum eu, tincidunt eu, varius ut, felis. Morbi mollis tellus ac sapien. Vestibulum ullamcorper mauris at ligula. In hac habitasse platea dictumst. Vivamus in erat ut urna cursus vestibulum.
    ">
<meta name="keywords" content="博客, 技术, 生物信息，精准医疗, 遗传咨询, 高通量技术, 算法, 学习, 作品, 写作, C&#43;&#43;, Perl">
<meta name="referrer" content="always">
<title>Item-22 Declare data members private - sy123.ml</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="/logo/favicon.ico" type="image/x-icon">
</head>
<body>
<header>
  <div>
    <h1><a href="https://sy123.ml/">sy123.ml</a></h1><h2><a href="https://sy123.ml/">winter is coming.</a></h2>
  </div>
  <nav><a href="/tags/">Tags</a><a href="/about/">About</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>Item-22 Declare data members private</h1>
  </div>
<div class="meta">
  <div>2018-02-10 00:00</div>
  <div>
    <span><a href="https://sy123.ml/tags/technique/">#technique</a></span>
      <span><a href="https://sy123.ml/tags/cpp/">#cpp</a></span>
      </div>
  </div>
<div class="content">
  <p>Declaring data members <code>private</code> gives clients syntactically uniform access to data, affords fine-grained access control, allows invariants to be enforced, and offers class authors implementation flexibility.</p>
<!-- toc -->
<h1 id="syntactic-consistency">Syntactic consistency</h1>
<p>If data member aren't public, the only way for clients to access an object is via member functions. If everything in the public interface is a function, clients know they will always use parentheses when accessing a member of the class, which is called &ldquo;sysntactic consistency&rdquo;.</p>
<h1 id="pricise-control-over-the-accessibility">Pricise control over the accessibility</h1>
<p>If we use functions to get or set data member's value, we can implement multiple levels of accessibility:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">AccessLevels</span> <span style="color:#111">{</span>
<span style="color:#00a8c8">public</span><span style="color:#f92672">:</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
    <span style="color:#00a8c8">int</span> <span style="color:#111">getReadOnly</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#00a8c8">const</span> <span style="color:#111">{</span> <span style="color:#00a8c8">return</span> <span style="color:#111">readOnly</span><span style="color:#111">;</span> <span style="color:#111">}</span>
    <span style="color:#00a8c8">int</span> <span style="color:#75af00">getReadWrite</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#00a8c8">const</span> <span style="color:#111">{</span> <span style="color:#00a8c8">return</span> <span style="color:#111">readWrite</span><span style="color:#111">;</span> <span style="color:#111">}</span>
    <span style="color:#00a8c8">void</span> <span style="color:#75af00">setReadWrite</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">value</span><span style="color:#111">)</span> <span style="color:#111">{</span> <span style="color:#111">readWrite</span> <span style="color:#f92672">=</span> <span style="color:#111">value</span><span style="color:#111">;</span> <span style="color:#111">}</span>
    <span style="color:#00a8c8">void</span> <span style="color:#75af00">setWriteOnly</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">value</span><span style="color:#111">)</span> <span style="color:#111">{</span> <span style="color:#111">writeOnly</span> <span style="color:#f92672">=</span> <span style="color:#111">value</span><span style="color:#111">;</span> <span style="color:#111">}</span>
<span style="color:#00a8c8">private</span><span style="color:#f92672">:</span>
    <span style="color:#00a8c8">int</span> <span style="color:#111">noAccess</span><span style="color:#111">;</span>   <span style="color:#75715e">// no access to this int
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">int</span> <span style="color:#111">readOnly</span><span style="color:#111">;</span>   <span style="color:#75715e">// read-only access to this int
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">int</span> <span style="color:#111">readWrite</span><span style="color:#111">;</span>  <span style="color:#75715e">// read-write access to this int
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">int</span> <span style="color:#111">writeOnly</span><span style="color:#111">;</span>  <span style="color:#75715e">// write-only access to this int
</span><span style="color:#75715e"></span><span style="color:#111">}</span><span style="color:#111">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Since it is rare that every data member need a getter and setter, such fine-grained access control is important.</p>
<h1 id="encapsulation">Encapsulation</h1>
<p>Encapsulation offers class authors implementation flexibility. Through a function, we can replace a data member with a computationi while nobody using the interface notice the change. For example, suppose we are writing an application monitoring the speed of passing cars, and each passing car's speed will be collected into the class:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">SpeedDataCollection</span> <span style="color:#111">{</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#00a8c8">public</span><span style="color:#f92672">:</span>
    <span style="color:#00a8c8">void</span> <span style="color:#111">addValue</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">speed</span><span style="color:#111">)</span><span style="color:#111">;</span>    <span style="color:#75715e">// add a new data value
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">double</span> <span style="color:#75af00">averageSoFar</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#00a8c8">const</span><span style="color:#111">;</span> <span style="color:#75715e">// return average speed
</span><span style="color:#75715e"></span>    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span><span style="color:#111">;</span>
</code></pre></td></tr></table>
</div>
</div><p>There are two ways to implement the member function <code>averageSoFar</code>:</p>
<ol>
<li>have a data member in the classs that is a running average of all the speed data so far collected. <code>averageSoFar</code> will simply return the value of this data member.</li>
<li>have <code>averageSoFar</code> compute its value anew each time it's called by examining each data value in the collection</li>
</ol>
<p>Both approaches have pros and cons, and decision on which to use depends on the specific use case:</p>
<ul>
<li>Method one makes each <code>SpeedDataCollection</code> object bigger for the extra data member holding the running average, the accumulated total, and the number of data points, but <code>averageSoFar</code> will be very efficient (it is just an inline function, see item 30). For an application where averages are needed frequently, and memory is not an issue, keeping a running average will be preferable.</li>
<li>Method two will make <code>averageSoFar</code> run slower, but each <code>SpeedDataCollection</code> object will be smaller. Thus it is preferable in applications where memory is tight (e.g., an embedded roadside device), and where averages are needed only infrequently</li>
</ul>
<p>The point is, by encapsulating the average through a member function, we can interchange different implementations, and clients will only have to, at most, recompile (we can even eliminate recompilation by the technique described in item 31). Since only member functions can affect data members, it is ensured that the class invariants are always maintained. Moreover, through function interfaces, we have flexibility for extra capabilities with ease (similar concept of &ldquo;properties&rdquo; in Delphi and C#, albeit with the need to type an extra set of parentheses):</p>
<ul>
<li>to notify other objects when data members are read or written</li>
<li>to verify class invariants and function pre-and postconditions</li>
<li>to perform synchronization in threaded environments</li>
</ul>
<p>On the other side, if we don't encapsulate data members from clients, we give up the right to change our future implementation decisions. Even if we own the source code to a class, our ability to chagne anything public is extremely restricted, because too much client code will be broken. Public means unencapsulated, and unencapsulated means unchangeable, which is especailly true for widely used classes.</p>
<h1 id="protected-data-members"><code>protected</code> data members</h1>
<p>The argument above is also applicable for <code>protected</code> data members. In fact, no only the reasoning about syntactic consistency and fine-grained access control is applicable, the argument on encapsulation is also true for them:<br>
suppose we eliminate a <code>protected</code> data member, and then all the derived classes using it, typically in an unknowably large amount of size, will be broken, which is exactly the same case for <code>public</code> data members used by large number of different clients.</p>
<p>Thus, from an encapsulation point of view, there are really only two access levels:</p>
<ol>
<li><code>private</code>, which offers encapsulation</li>
<li>everything else, which doesn't</li>
</ol></div>

  </article>
</main>
<footer>
  <div>
    <div>
      2007-2020 Zhili.</div>
  </div>
</footer>
</body>
</html>
