<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Zhili">
<meta name="description" content="Sed magna purus, fermentum eu, tincidunt eu, varius ut, felis. Morbi mollis tellus ac sapien. Vestibulum ullamcorper mauris at ligula. In hac habitasse platea dictumst. Vivamus in erat ut urna cursus vestibulum.
    ">
<meta name="keywords" content="博客, 技术, 生物信息，精准医疗, 遗传咨询, 高通量技术, 算法, 学习, 作品, 写作, C&#43;&#43;, Perl">
<meta name="referrer" content="always">
<title>[EMCpp]Item-7 Distinguish Betwenn () and {} When Creating Objects - sy123.ml</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="/logo/favicon.ico" type="image/x-icon">
</head>
<body>
<header>
  <div>
    <h1><a href="https://sy123.ml/">sy123.ml</a></h1><h2><a href="https://sy123.ml/">winter is coming.</a></h2>
  </div>
  <nav><a href="/tags/">Tags</a><a href="/about/">About</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>[EMCpp]Item-7 Distinguish Betwenn () and {} When Creating Objects</h1>
  </div>
<div class="meta">
  <div>2018-07-10 18:55</div>
  <div>
    <span><a href="https://sy123.ml/tags/technique/">#technique</a></span>
      <span><a href="https://sy123.ml/tags/cpp/">#cpp</a></span>
      </div>
  </div>
<div class="content">
  <p>Braced initialization is the most widely usable initialization syntax, which can also prevent narrowing conversions, as well as being immune to C++'s most vexing parse.</p>
<!-- toc -->
<h1 id="the-good-part">The good part</h1>
<h2 id="syntacticly-widest-usage">Syntacticly widest usage</h2>
<p>Syntax choices for object initialization in C++11 are confusing to support 3 forms: parentheses, equal signs, and braces.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">int</span> <span style="color:#75af00">x</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">)</span><span style="color:#111">;</span>   <span style="color:#75715e">// initializer with parentheses
</span><span style="color:#75715e"></span><span style="color:#00a8c8">int</span> <span style="color:#111">y</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#111">;</span>  <span style="color:#75715e">// initializer with &#34;=&#34;
</span><span style="color:#75715e"></span><span style="color:#00a8c8">int</span> <span style="color:#111">z</span><span style="color:#111">{</span> <span style="color:#ae81ff">0</span> <span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// initializer with braces
</span><span style="color:#75715e"></span><span style="color:#00a8c8">int</span> <span style="color:#111">zz</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#ae81ff">0</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// initializer with &#34;=&#34; and braces, treated the same as braces-only version.
</span><span style="color:#75715e"></span>
<span style="color:#111">Widget</span> <span style="color:#111">w1</span><span style="color:#111">;</span>  <span style="color:#75715e">// default ctor.
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w2</span> <span style="color:#f92672">=</span> <span style="color:#111">w1</span><span style="color:#111">;</span> <span style="color:#75715e">// copy ctor
</span><span style="color:#75715e"></span><span style="color:#111">w1</span> <span style="color:#f92672">=</span> <span style="color:#111">w2</span><span style="color:#111">;</span>  <span style="color:#75715e">// assignment, calls copy operator=
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// easy to specify the init. content of a container
</span><span style="color:#75715e"></span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">vector</span><span style="color:#f92672">&lt;</span><span style="color:#00a8c8">int</span><span style="color:#f92672">&gt;</span> <span style="color:#111">v</span><span style="color:#111">{</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#ae81ff">5</span> <span style="color:#111">}</span><span style="color:#111">;</span>  <span style="color:#75715e">// v&#39;s init. content is 1, 3, 5
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// specify default init. value for non-static data members, where parentheses not allowed
</span><span style="color:#75715e"></span><span style="color:#00a8c8">class</span> <span style="color:#75af00">Widget</span> <span style="color:#111">{</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#00a8c8">private</span><span style="color:#f92672">:</span>
    <span style="color:#00a8c8">int</span> <span style="color:#111">x</span><span style="color:#111">{</span> <span style="color:#ae81ff">0</span> <span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// fine
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">int</span> <span style="color:#111">y</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#111">;</span>  <span style="color:#75715e">// fine
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">int</span> <span style="color:#75af00">z</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">)</span><span style="color:#111">;</span>   <span style="color:#75715e">// error
</span><span style="color:#75715e"></span><span style="color:#111">}</span><span style="color:#111">;</span>

<span style="color:#75715e">// specify init. value for uncopyable objects (EMCpp item 40), where &#34;=&#34; not allowed
</span><span style="color:#75715e"></span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">atomic</span><span style="color:#f92672">&lt;</span><span style="color:#00a8c8">int</span><span style="color:#f92672">&gt;</span> <span style="color:#111">ai1</span><span style="color:#111">{</span> <span style="color:#ae81ff">0</span> <span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// fine
</span><span style="color:#75715e"></span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">atomic</span><span style="color:#f92672">&lt;</span><span style="color:#00a8c8">int</span><span style="color:#f92672">&gt;</span> <span style="color:#111">ai2</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">)</span><span style="color:#111">;</span>   <span style="color:#75715e">// fine
</span><span style="color:#75715e"></span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">atomic</span><span style="color:#f92672">&lt;</span><span style="color:#00a8c8">int</span><span style="color:#f92672">&gt;</span> <span style="color:#111">ai3</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#111">;</span>  <span style="color:#75715e">// error
</span></code></pre></td></tr></table>
</div>
</div><p>From the example above, it's easy to see why braced initialization is called &ldquo;uniform&rdquo; - a single initialization syntax that aims to be used anywhere and express everything.</p>
<h2 id="preventing-narrowing-conversion">Preventing narrowing conversion</h2>
<p>Braced initialization prohibits implicit <em>narrowing conversions</em> among built-in types:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">double</span> <span style="color:#111">x</span><span style="color:#111">,</span> <span style="color:#111">y</span><span style="color:#111">,</span> <span style="color:#111">z</span><span style="color:#111">;</span>
<span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#00a8c8">int</span> <span style="color:#111">sum1</span><span style="color:#111">{</span> <span style="color:#111">x</span> <span style="color:#f92672">+</span> <span style="color:#111">y</span> <span style="color:#f92672">+</span> <span style="color:#111">z</span> <span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// error
</span><span style="color:#75715e"></span><span style="color:#00a8c8">int</span> <span style="color:#75af00">sum2</span><span style="color:#111">(</span><span style="color:#111">x</span> <span style="color:#f92672">+</span> <span style="color:#111">y</span> <span style="color:#f92672">+</span> <span style="color:#111">z</span><span style="color:#111">)</span><span style="color:#111">;</span>  <span style="color:#75715e">// okay to truncate value of expression to an int
</span><span style="color:#75715e"></span><span style="color:#00a8c8">int</span> <span style="color:#111">sum3</span> <span style="color:#f92672">=</span> <span style="color:#111">x</span> <span style="color:#f92672">+</span> <span style="color:#111">y</span> <span style="color:#f92672">+</span> <span style="color:#111">z</span><span style="color:#111">;</span> <span style="color:#75715e">// ditto
</span></code></pre></td></tr></table>
</div>
</div><h2 id="immune-to-most-vexing-parse">Immune to most vexing parse</h2>
<p><em>Most vexing parse</em>: anything that can be parsed as a declaration must be interpreted as one. This may be annoying when developers want to default-construct an object, but inadvertently end up declaring a function instead. Using braces, we don't have such an issue:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#111">Widget</span> <span style="color:#75af00">w1</span><span style="color:#111">(</span><span style="color:#ae81ff">10</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// call Widget ctor with arg. 10
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#75af00">w2</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">;</span>  <span style="color:#75715e">// intend to call a Widget const. with zero arg., end up declaring a func. named w2 that returns a Widget
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w3</span><span style="color:#111">{</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// calls Widget ctor with no args.
</span></code></pre></td></tr></table>
</div>
</div><h1 id="the-not-so-good-part">The not-so-good part</h1>
<h2 id="unintuitive-behavior-with-auto">Unintuitive behavior with <code>auto</code></h2>
<p>As EMCpp item 2 explains, when an <code>auto</code>-declared variable has a braced initializer, the type deduced is <code>std::initializer_list</code>, which may lead to surprising behaviors sometimes.</p>
<h2 id="too-high-overloading-priority">(Too) high overloading priority</h2>
<p>Calls using braced initialization syntax strongly prefer the overloads taking <code>std::initializer_list</code>s: if there's any way for compilers to construe a call using a braced initializer to be to a constructor taking a <code>std::initializer_list</code>, compilers will employ that interpretation:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Widget</span> <span style="color:#111">{</span>
<span style="color:#00a8c8">public</span><span style="color:#f92672">:</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">i</span><span style="color:#111">,</span> <span style="color:#00a8c8">bool</span> <span style="color:#111">b</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">i</span><span style="color:#111">,</span> <span style="color:#00a8c8">double</span> <span style="color:#111">d</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">initializer_list</span><span style="color:#f92672">&lt;</span><span style="color:#00a8c8">long</span> <span style="color:#00a8c8">double</span><span style="color:#f92672">&gt;</span> <span style="color:#111">il</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#00a8c8">operator</span> <span style="color:#75af00">float</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#00a8c8">const</span><span style="color:#111">;</span> <span style="color:#75715e">// convert to float
</span><span style="color:#75715e"></span>    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span><span style="color:#111">;</span>

<span style="color:#111">Widget</span> <span style="color:#75af00">w1</span><span style="color:#111">(</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#111">true</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// calls first ctor.
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w2</span><span style="color:#111">{</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#111">true</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// calls std::initializer_list ctor, 10 and true convert to long double
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#75af00">w3</span><span style="color:#111">(</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">5.6</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// calls second ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w4</span><span style="color:#111">{</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">5.6</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// calls std::initializer_list ctor, 10 and 5.6 convert to long double
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#75af00">w5</span><span style="color:#111">(</span><span style="color:#111">w4</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// calls copy ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w6</span><span style="color:#111">{</span><span style="color:#111">w4</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// calls std::initializer_list ctor, w4 converts to float, and float converts to long double
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#75af00">w7</span><span style="color:#111">(</span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">move</span><span style="color:#111">(</span><span style="color:#111">w4</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// calls move ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w8</span><span style="color:#111">{</span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">move</span><span style="color:#111">(</span><span style="color:#111">w4</span><span style="color:#111">)</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// calls std::initializer_list ctor, same conversion as w6
</span></code></pre></td></tr></table>
</div>
</div><p>The priority is so high that it prevails even if the best-match <code>std-initializer_list</code> constructor can't be called:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Widget</span> <span style="color:#111">{</span>
<span style="color:#00a8c8">public</span><span style="color:#f92672">:</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">i</span><span style="color:#111">,</span> <span style="color:#00a8c8">bool</span> <span style="color:#111">b</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">i</span><span style="color:#111">,</span> <span style="color:#00a8c8">double</span> <span style="color:#111">d</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">initializer_list</span><span style="color:#f92672">&lt;</span><span style="color:#00a8c8">bool</span><span style="color:#f92672">&gt;</span> <span style="color:#111">il</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// no implicit conversion funcs
</span><span style="color:#75715e"></span>    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span><span style="color:#111">;</span>

<span style="color:#111">Widget</span> <span style="color:#111">w</span><span style="color:#111">{</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">5.0</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// error: requires narrowing conversions. The other callable ctors is shadowed
</span></code></pre></td></tr></table>
</div>
</div><p>Only if there's no way to convert the types of the arguments in a braced initializer to the type in a <code>std::initializer_list</code> do compilers fall back on normal overload resolution:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Widget</span> <span style="color:#111">{</span>
<span style="color:#00a8c8">public</span><span style="color:#f92672">:</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">i</span><span style="color:#111">,</span> <span style="color:#00a8c8">bool</span> <span style="color:#111">b</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">i</span><span style="color:#111">,</span> <span style="color:#00a8c8">double</span> <span style="color:#111">d</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">initializer_list</span><span style="color:#f92672">&lt;</span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">string</span><span style="color:#f92672">&gt;</span> <span style="color:#111">il</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// no implicit conversion funcs
</span><span style="color:#75715e"></span>    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span><span style="color:#111">;</span>

<span style="color:#111">Widget</span> <span style="color:#75af00">w1</span><span style="color:#111">(</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#111">true</span><span style="color:#111">)</span><span style="color:#111">;</span>  <span style="color:#75715e">// calls first ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w2</span><span style="color:#111">{</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#111">true</span><span style="color:#111">}</span><span style="color:#111">;</span>  <span style="color:#75715e">// calls first ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#75af00">w3</span><span style="color:#111">(</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">5.0</span><span style="color:#111">)</span><span style="color:#111">;</span>  <span style="color:#75715e">// calls second ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w3</span><span style="color:#111">{</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">5.0</span><span style="color:#111">}</span><span style="color:#111">;</span>  <span style="color:#75715e">// calls second ctor
</span></code></pre></td></tr></table>
</div>
</div><p><strong>Edge case</strong>: Empty braces mean no arguments, not an empty <code>std::initializer_list</code>. For example</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Widget</span> <span style="color:#111">{</span>
<span style="color:#00a8c8">public</span><span style="color:#f92672">:</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#111">(</span><span style="color:#111">std</span><span style="color:#f92672">:</span><span style="color:#f92672">:</span><span style="color:#111">initializer_list</span><span style="color:#f92672">&lt;</span><span style="color:#00a8c8">int</span><span style="color:#f92672">&gt;</span> <span style="color:#111">il</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// no implicit conversion funcs
</span><span style="color:#75715e"></span>    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span><span style="color:#111">;</span>

<span style="color:#111">Widget</span> <span style="color:#111">w1</span><span style="color:#111">;</span> <span style="color:#75715e">// calls default ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#75af00">w2</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// calls default ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#111">w3</span><span style="color:#111">{</span><span style="color:#111">}</span><span style="color:#111">;</span> <span style="color:#75715e">// calls default ctor
</span><span style="color:#75715e"></span><span style="color:#111">Widget</span> <span style="color:#75af00">w4</span><span style="color:#111">(</span><span style="color:#111">{</span><span style="color:#111">}</span><span style="color:#111">)</span><span style="color:#111">;</span> <span style="color:#75715e">// calls std::initializer_list ctor with empty list
</span></code></pre></td></tr></table>
</div>
</div></div>

  </article>
</main>
<footer>
  <div>
    <div>
      2007-2020 Zhili.</div>
  </div>
</footer>
</body>
</html>
