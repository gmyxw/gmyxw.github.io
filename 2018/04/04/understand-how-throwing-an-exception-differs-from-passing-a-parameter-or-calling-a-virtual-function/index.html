<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Zhili">
<meta name="description" content="Sed magna purus, fermentum eu, tincidunt eu, varius ut, felis. Morbi mollis tellus ac sapien. Vestibulum ullamcorper mauris at ligula. In hac habitasse platea dictumst. Vivamus in erat ut urna cursus vestibulum.
    ">
<meta name="keywords" content="博客, 技术, 生物信息，精准医疗, 遗传咨询, 高通量技术, 算法, 学习, 作品, 写作, C&#43;&#43;, Perl">
<meta name="referrer" content="always">
<title>[MECpp]Item-12 Understand How Throwing an Exception Differs From Passing a Parameter or Calling a Virtual Function - sy123.ml</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="/logo/favicon.ico" type="image/x-icon">
</head>
<body>
<header>
  <div>
    <h1><a href="https://sy123.ml/">sy123.ml</a></h1><h2><a href="https://sy123.ml/">winter is coming.</a></h2>
  </div>
  <nav><a href="/tags/">Tags</a><a href="/about/">About</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>[MECpp]Item-12 Understand How Throwing an Exception Differs From Passing a Parameter or Calling a Virtual Function</h1>
  </div>
<div class="meta">
  <div>2018-04-04 11:28</div>
  <div>
    <span><a href="https://sy123.ml/tags/technique/">#technique</a></span>
      <span><a href="https://sy123.ml/tags/cpp/">#cpp</a></span>
      </div>
  </div>
<div class="content">
  <p>There are three primary ways in which passing an object to a function or using that object to invoke a virtual function differs from throwing the object as an exception.</p>
<!-- toc -->
<h1 id="similarity">Similarity</h1>
<p>There is similarity between passing an argument from a function call site to the function's parameter and passing an exception from a <code>throw</code> site to a <code>catch</code> clause:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Widget</span> <span style="color:#111">{</span><span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">}</span>

<span style="color:#00a8c8">void</span> <span style="color:#75af00">f1</span><span style="color:#111">(</span><span style="color:#111">Widget</span> <span style="color:#111">w</span><span style="color:#111">)</span><span style="color:#111">;</span>
<span style="color:#00a8c8">void</span> <span style="color:#75af00">f2</span><span style="color:#111">(</span><span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span><span style="color:#111">;</span>
<span style="color:#00a8c8">void</span> <span style="color:#75af00">f3</span><span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span><span style="color:#111">;</span>
<span style="color:#00a8c8">void</span> <span style="color:#75af00">f4</span><span style="color:#111">(</span><span style="color:#111">Widget</span> <span style="color:#f92672">*</span><span style="color:#111">pw</span><span style="color:#111">)</span><span style="color:#111">;</span>
<span style="color:#00a8c8">void</span> <span style="color:#75af00">f5</span><span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">Widget</span> <span style="color:#f92672">*</span><span style="color:#111">pw</span><span style="color:#111">)</span><span style="color:#111">;</span>

<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">Widget</span> <span style="color:#111">w</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">Widget</span> <span style="color:#f92672">*</span><span style="color:#111">pw</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">Widget</span> <span style="color:#f92672">*</span><span style="color:#111">pw</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="differences">Differences</h1>
<p>However, there are still three difference:</p>
<ol>
<li>exception objects are always copied (when caught by value, they are copied twice), while objects passed to function parameters need not be copied at all.</li>
<li>objects thrown as exceptions are subject to fewer forms of type conversion than are objects passed to functions.</li>
<li><code>catch</code> clauses are examined in the order in which they appear in the source code, and the first one that can succeed is selected for execution, while a virtual funciton invoked by an object is the one that provides the <em>best</em> match for the type of the object, even if it's not the first one listed in the source code.</li>
</ol>
<h2 id="difference-in-augument-passing">Difference in augument passing</h2>
<p>The first difference essentially grows out of the fact that when we call a function, control eventually returns to the call site, but when we throw an exception, constrol does <em>not</em> return to the <code>throw</code> site. For example:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">void</span> <span style="color:#75af00">throwWidget</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">{</span>
    <span style="color:#111">Widget</span> <span style="color:#111">localWidget</span><span style="color:#111">;</span>
    <span style="color:#00a8c8">throw</span> <span style="color:#111">localWidget</span><span style="color:#111">;</span> <span style="color:#75715e">// throw localWidget as an exception
</span><span style="color:#75715e"></span><span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In this typical case where <code>localWidget</code> will go out of scope once control leaves <code>throwWidget</code>, its destructor will be called, so C++ specifies that an object thrown as an exception is copied (even if the object being thrown is not in danger of being destroyed). This mandatory copying of exception objects leads to two implication:</p>
<ul>
<li>It is not possible for the <code>catch</code> block to modify <code>localWidget</code>; it can only modify a <em>copy</em> of <code>localWidget</code></li>
<li>Throwing an exception is typically much slower than parameter passing.</li>
</ul>
<h3 id="copying-based-on-static-type">Copying based on static type</h3>
<p>It is worth noting that in C++ copying is always based on an object's static type (MECpp item 25 shows a technique to copy based on dynamic type). Thus,</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Widget</span> <span style="color:#111">{</span><span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">}</span><span style="color:#111">;</span>
<span style="color:#00a8c8">class</span> <span style="color:#75af00">SpecialWidget</span><span style="color:#f92672">:</span> <span style="color:#00a8c8">public</span> <span style="color:#111">Widget</span> <span style="color:#111">{</span><span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">}</span><span style="color:#111">;</span>

<span style="color:#00a8c8">void</span> <span style="color:#75af00">throwWidget</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">{</span>
    <span style="color:#111">SpecialWidget</span> <span style="color:#111">localSpecialWidget</span><span style="color:#111">;</span>
    <span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">rw</span> <span style="color:#f92672">=</span> <span style="color:#111">localSpecialWidget</span> <span style="color:#75715e">// rw refers to a SpecialWidget
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">throw</span> <span style="color:#111">rw</span><span style="color:#111">;</span>  <span style="color:#75715e">// this throws an exception of type Widget
</span><span style="color:#75715e"></span><span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="rethrow">Rethrow</h3>
<p>Another impact caused from copying exceptions objects is that there's difference between different rethrow statements:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span>  <span style="color:#75715e">// catch Widget exceptions
</span><span style="color:#75715e"></span><span style="color:#111">{</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
    <span style="color:#00a8c8">throw</span><span style="color:#111">;</span>  <span style="color:#75715e">// rethrow the exception so it continues to propagate
</span><span style="color:#75715e"></span><span style="color:#111">}</span>

<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span>  <span style="color:#75715e">// catch Widget exceptions
</span><span style="color:#75715e"></span><span style="color:#111">{</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
    <span style="color:#00a8c8">throw</span> <span style="color:#111">w</span><span style="color:#111">;</span>  <span style="color:#75715e">// propagate a copy of the caught exception
</span><span style="color:#75715e"></span><span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Here, the first block rethrows the current exception, while the second one throws a new copy of the current exception. Apart from performance cost of the additional copy operation in the second block, there's another suble difference: if the exception originally thrown was of type <code>SpecialWidget</code>, the first block would propagate a <code>SpecialWidget</code> exception (even though <code>w</code>'s static type is <code>Widget</code>) and no copy is made during <code>throw;</code>, while the second <code>catch</code> block throws a <em>new</em> exception being the type of <code>Widget</code>.</p>
<p>In general, we'll want to use the</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">throw</span><span style="color:#111">;</span>
</code></pre></td></tr></table>
</div>
</div><p>syntax to rethrow the current exception for its consistency and efficiency.</p>
<h3 id="different-catch-syntax">Different <code>catch</code> syntax</h3>
<p>There are three kinds of <code>catch</code> clauses for exception of type <code>Widget</code>:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">Widget</span> <span style="color:#111">w</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>  <span style="color:#75715e">// catch by value
</span><span style="color:#75715e"></span><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span> <span style="color:#75715e">// catch by reference
</span><span style="color:#75715e"></span><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">Widget</span><span style="color:#f92672">&amp;</span> <span style="color:#111">w</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span> <span style="color:#75715e">// catch by reference-to-const
</span></code></pre></td></tr></table>
</div>
</div><p>A few points to note:</p>
<ul>
<li>A thrown object (which is always a copied temporary) may be caught by simple reference, but it is not allowed in function calls (item 19) to pass a temporary object to a non-<code>const</code> reference parameter.</li>
<li>The first statement (catch by value) leads to <em>two</em> copies of the thrown object, one to create the temporary that all exceptions generate, the other to copy that temporary into <code>w</code>.</li>
<li>For the catch by reference and catch by reference-to-const, we expect to pay for one copy of the exception. In contrast, when we pass function parameters by reference (or reference-to-const), no copying takes place.</li>
<li>Throw by pointer is equivalent to pass by pointer. Either way, a copy of the pointer is passed. Just remember not to throw a pointer to a local object.</li>
</ul>
<h2 id="difference-in-type-matching">Difference in type matching</h2>
<p>Implicit conversions (such from <code>int</code> to <code>double</code>) are not applied when matching exceptions to <code>catch</code> clauses:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">void</span> <span style="color:#75af00">f</span><span style="color:#111">(</span><span style="color:#00a8c8">int</span> <span style="color:#111">value</span><span style="color:#111">)</span>
<span style="color:#111">{</span>
    <span style="color:#00a8c8">try</span> <span style="color:#111">{</span>
        <span style="color:#00a8c8">if</span> <span style="color:#111">(</span><span style="color:#111">someFunction</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span> <span style="color:#111">{</span>
            <span style="color:#00a8c8">throw</span> <span style="color:#111">value</span><span style="color:#111">;</span>
        <span style="color:#111">}</span>
        <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
    <span style="color:#111">}</span>
    <span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#00a8c8">double</span> <span style="color:#111">d</span><span style="color:#111">)</span> <span style="color:#111">{</span> <span style="color:#75715e">// handle double type exceptions
</span><span style="color:#75715e"></span>        <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
    <span style="color:#111">}</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In this case, the <code>int</code> exception thrown in <code>try</code> block will never be caught by the <code>catch</code> clause taking a <code>double</code>.</p>
<p>Basically, two kinds of conversions are applied during <code>catch</code> matching:</p>
<ol>
<li>
<p>inheritance-based conversions
For example, <code>range_error</code>, <code>underflow_error</code>, and <code>overflow_error</code> are derived types from <code>runtime_error</code>:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">runtime_error</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>         <span style="color:#75715e">// can catch errors of type
</span><span style="color:#75715e"></span><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">runtime_error</span><span style="color:#f92672">&amp;</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>        <span style="color:#75715e">// runtime_error,
</span><span style="color:#75715e"></span><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">runtime_error</span><span style="color:#f92672">&amp;</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>  <span style="color:#75715e">// range_error, or overflow_error
</span><span style="color:#75715e"></span>   
<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">runtime_error</span><span style="color:#f92672">*</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>        <span style="color:#75715e">// can catch errors of type runtime_error*
</span><span style="color:#75715e"></span><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">runtime_error</span><span style="color:#f92672">*</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>  <span style="color:#75715e">// range_error*, or overflow_error*
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>from a typed to an untyped pointer</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#00a8c8">void</span><span style="color:#f92672">*</span><span style="color:#111">)</span> <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>   <span style="color:#75715e">// catches any exception that&#39;s a pointer
</span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="difference-in-fitting-strategy">Difference in fitting strategy</h2>
<p>Catch clauses are always tried in the order of their appearance (employing a &ldquo;first fit&rdquo; strategy). For exampel:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">try</span> <span style="color:#111">{</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span>
<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">logic_error</span><span style="color:#f92672">&amp;</span> <span style="color:#111">ex</span><span style="color:#111">)</span> <span style="color:#111">{</span>  <span style="color:#75715e">// this block will catch all logic_error exceptions
</span><span style="color:#75715e"></span>    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>                    <span style="color:#75715e">// including invalid_argument exception, which is derived type
</span><span style="color:#75715e"></span><span style="color:#111">}</span>
<span style="color:#00a8c8">catch</span> <span style="color:#111">(</span><span style="color:#111">invalid_argument</span><span style="color:#f92672">&amp;</span> <span style="color:#111">ed</span><span style="color:#111">)</span> <span style="color:#111">{</span>
    <span style="color:#111">.</span><span style="color:#111">.</span><span style="color:#111">.</span>
<span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><p>on the contrary, when we call a virtual function, the function invoked is the one in the class <code>closest</code> to the dynamica type of the object invoking the function (employing a &ldquo;best fit&rdquo; algorithm).</p></div>

  </article>
</main>
<footer>
  <div>
    <div>
      2007-2020 Zhili.</div>
  </div>
</footer>
</body>
</html>
